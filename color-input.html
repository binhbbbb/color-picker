<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../number-input/number-input.html">
<link rel="import" href="../text-input/text-input.html">
<link rel="import" href="color-badge.html">

<script>
  /**
   * Mixin for color-input
   *
   * @appliesMixin ColorBadgePattern
   *
   * @mixinFunction
   * @polymer
   */
  const ColorInputPattern = (superClass) => class extends ColorBadgePattern(superClass) { // eslint-disable-line no-unused-vars, no-undef

    static get styleTemplate() {
      return `
        <style include="${this.customStyleToInclude}">
          ${this.customStyleContent}
        </style>
      `;
    }

    static get customStyleToInclude() {
      return '';
    }

    static get customStyleContent() {
      return `
        ${super.customStyleContent || ''}
        #colorInput {
          display: inline-flex;
          flex-direction: row;
          align-items: center;
        }
        #colorBadge {
          position: relative;
        }
      `;
    }

    static get colorInputTemplate() {
      return `
        ${super.colorInputTemplate || ''}
        <div id="colorInput" on-contextmenu="random">
          ${this.colorBadgeTemplate || ''}
          <template is="dom-if" if="[[_computeIsInFormat('hex', format)]]" restamp>
            <text-input id="hex" value="{{hex}}" required pattern="^#(?:[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$" size="7" maxlength="7" minlength="4"></text-input>
          </template>
          <template is="dom-if" if="[[_computeIsInFormat('rgb', format)]]" restamp>
            <number-input id="r" value="{{r}}" step="1" min="0" max="255"></number-input>
            <number-input id="g" value="{{g}}" step="1" min="0" max="255"></number-input>
            <number-input id="b" value="{{b}}" step="1" min="0" max="255"></number-input>
          </template>
          <template is="dom-if" if="[[_computeIsInFormat('hsl', format)]]" restamp>
            <number-input id="h" value="{{h}}" step="1" min="0" max="360"></number-input>
            <number-input id="s" value="{{s}}" in-percent step="0.01" min="0" max="1"></number-input>
            <number-input id="l" value="{{l}}" in-percent step="0.01" min="0" max="1"></number-input>
          </template>
          <number-input id="alpha" value="{{alpha}}" no-clamp step="0.01" min="0" max="1"></number-input>
        </div>
      `
    }

    static get colorBadgeSlotTemplate() {
      return '';
    }

    _computeIsInFormat(expectedFormat, format) {
      return expectedFormat === format;
    }

  }
</script>

<dom-module id="color-input">
  <script>
  /**
  * `<color-input>` adds a color input to your page using Polymer.
  *
  *   ```html
  *     <color-input value="{{color}}"></color-input>
  *   ```
  *
  *
  * The following custom properties and mixins are also available for styling:
  *
  * Custom property | Description | Default
  * ----------------|-------------|----------
  *
  * @customElement
  * @polymer
  *
  * @appliesMixin ColorInputPattern
  *
  * @demo demo/index.html
  **/
    class ColorSelector extends ColorInputPattern(Polymer.Element) { // eslint-disable-line no-undef

      static get is() {
        return 'color-input';
      }

      static get template() {
        return `
          ${this.styleTemplate}
          ${this.colorInputTemplate}
        `
      }

    }
    window.customElements.define(ColorSelector.is, ColorSelector);
  </script>
</dom-module>
